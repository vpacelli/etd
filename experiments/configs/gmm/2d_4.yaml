experiment:
  name: "gmm-2d-4"
  seeds: [0, 1, 2, 3, 4]

  target:
    type: "gmm"
    params:
      dim: 2
      n_modes: 4
      arrangement: "grid"
      separation: 6.0
      component_std: 1.0

  shared:
    n_particles: 100
    n_iterations: 500
    init:
      type: "gaussian"
      scale: 5.0

  checkpoints: [0, 1, 5, 10, 25, 50, 100, 200, 500]

  metrics:
    - "sliced_wasserstein"
    - "energy_distance"
    - "mode_proximity"
    - "mode_balance"
    - "mean_error"
    - "coupling_ess"
    - "sinkhorn_iters"

  algorithms:
    # - label: "ETD-B"
    #   cost: "euclidean"
    #   coupling: "balanced"
    #   update: "categorical"
    #   epsilon: 0.1
    #   proposal:
    #     alpha: 0.05

    # - label: "ETD-SR"
    #   cost: "euclidean"
    #   coupling: "gibbs"
    #   update: "categorical"
    #   epsilon: 0.1
    #   proposal:
    #     alpha: 0.05

    # - label: "ETD-B-SF"
    #   cost: "euclidean"
    #   coupling: "balanced"
    #   update: "categorical"
    #   epsilon: 0.1
    #   proposal:
    #     type: "score_free"
    #     alpha: 0.0

    - label: "SVGD"
      type: "baseline"
      method: "svgd"
      stepsize: 0.1
      clip_score: 5.0

    # - label: "ULA"
    #   type: "baseline"
    #   method: "ula"
    #   stepsize: 0.01
    #   clip_score: 5.0

    - label: "MALA"
      type: "baseline"
      method: "mala"
      stepsize: 0.01
      clip_score: 5.0

    - label: "ETD-B"
      cost: "euclidean"
      coupling: "balanced"
      update: "categorical"
      epsilon: 0.1
      proposal:
        alpha: 0.05
      preconditioner:
        type: "cholesky"
        proposals: true
        cost: true
        source: positions
        ema: 0.8
        shrinkage: 0.1
        jitter: 1e-6

    - label: "MPPI"
      type: "baseline"
      method: "mppi"
      temperature: 1.0
      sigma: 0.316
      n_proposals: 25

    # --- LRET: Langevin-adapted transport geometry ---
    - label: "LRET-B"
      cost: {type: "langevin"}
      coupling: "balanced"
      update: "categorical"
      epsilon: [0.01, 0.05, 0.1, 0.5]
      proposal:
        count: 25

    - label: "LRET-B-W"
      cost: {type: "langevin", whiten: true}
      coupling: "balanced"
      update: "categorical"
      epsilon: [0.01, 0.05, 0.1, 0.5]
      proposal:
        count: 25
      preconditioner:
        type: "cholesky"
        proposals: true
        cost: true
        shrinkage: 0.1

    # --- Mutation: MCMC rejuvenation after transport ---
    - label: "ETD-B+MALA"
      cost: "euclidean"
      coupling: "balanced"
      update: "categorical"
      epsilon: 0.1
      proposal:
        alpha: 0.05
        count: 25
      mutation:
        kernel: "mala"
        steps: [1, 3, 5, 10]
        stepsize: [0.005, 0.01, 0.05, 0.1]
        cholesky: true
      preconditioner:
        type: "cholesky"
        proposals: true
        cost: true
        shrinkage: 0.1

    # --- Combined: LRET geometry + MALA mutation ---
    # - label: "LRET-B+MALA"
    #   cost: {type: "langevin", whiten: true}
    #   coupling: "balanced"
    #   update: "categorical"
    #   epsilon: 0.1
    #   proposal:
    #     count: 25
    #   mutation:
    #     kernel: "mala"
    #     steps: 5
    #     stepsize: 0.05
    #     cholesky: true
    #   preconditioner:
    #     type: "cholesky"
    #     proposals: true
    #     cost: true
    #     shrinkage: 0.1
