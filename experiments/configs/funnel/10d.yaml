experiment:
  name: "funnel-10d"
  seeds: [0, 1, 2, 3, 4]

  target:
    type: "funnel"
    params:
      dim: 10
      sigma_v: 3.0

  shared:
    n_particles: 100
    n_iterations: 2000
    init:
      type: "gaussian"
      scale: 2.0

  checkpoints: [0, 1, 10, 50, 100, 200, 500, 1000, 2000]

  metrics:
    - "sliced_wasserstein"
    - "energy_distance"
    - "variance_ratio_ref"
    - "mean_error"
    - "coupling_ess"
    - "sinkhorn_iters"

  algorithms:
    - label: "ETD-B"
      cost: euclidean
      coupling:
        type: "balanced"
        tolerance: 1e-3
        iterations: 250
        damping: [0.1, 0.25, 0.5]
      update: categorical
      epsilon: 0.01
      proposal:
        alpha: 0.5
        clip_score: 1.0 # 0.1 # Should rerun with even more clipping
        count: 25
      preconditioner:
        type: "cholesky"
        proposals: true
        cost: true
        source: positions
        ema: 0.8

    - label: "LRET-B-W"
      cost:
        type: "langevin"
        whiten: true
      coupling:
        type: "balanced"
        tolerance: 1e-3
        iterations: 250
        damping: [0.1, 0.25, 0.5]
      update: "categorical"
      epsilon: 0.1
      proposal:
        alpha: 0.5
        clip_score: 1.0 # 0.1 # Should rerun with even more clipping
        count: 25
      preconditioner:
        type: "cholesky"
        proposals: true
        cost: true
        source: positions
        ema: 0.8

    # - label: ETD-B
    #   sublabel: MALA
    #   cost: euclidean
    #   coupling:
    #     type: "balanced"
    #     tolerance: 1e-3
    #     iterations: 250
    #     damping: 0.5
    #   update: categorical
    #   epsilon: 0.01
    #   proposal:
    #     alpha: 0.5
    #     clip_score: 0.1
    #     count: 25
    #   mutation:
    #     kernel: mala
    #     steps: 5
    #     stepsize: 0.005
    #     clip_score: 5.0
    #     cholesky: true
    #   preconditioner:
    #     type: "cholesky"
    #     proposals: true
    #     cost: true
    #     source: positions
    #     ema: 0.8

    - label: "SVGD"
      type: "baseline"
      method: "svgd"
      stepsize: 0.1
      clip_score: 5.0

    - label: "MALA"
      type: "baseline"
      method: "mala"
      stepsize: 0.005
      clip_score: 0.1
      preconditioner: "cholesky"
